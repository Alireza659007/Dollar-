<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø³Ø§Ù…Ø§Ù†Ù‡ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ùˆ Ø¬ÙˆØ§ÛŒØ²</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 20px; background: #f3f3f3; }
    input, button { margin: 6px; padding: 8px 12px; font-size: 16px; }
    #output { margin-top: 20px; color: #333; font-weight: bold; }
    table { margin: 20px auto; border-collapse: collapse; }
    th, td { padding: 8px 12px; border: 1px solid #aaa; }
    h2 { margin-top: 40px; }
  </style>
</head>
<body>
  <h1>ğŸ‰ Ø³Ø§Ù…Ø§Ù†Ù‡ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ùˆ Ø¯Ø±ÛŒØ§ÙØª Ø§Ù…ØªÛŒØ§Ø²</h1>

  <h2>Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… ÛŒØ§ ÙˆØ±ÙˆØ¯</h2>
  <input id="username" placeholder="Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ">
  <button onclick="login()">ÙˆØ±ÙˆØ¯</button>

  <h2>ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù† Ú©Ø¯</h2>
  <input id="usercode" placeholder="Ú©Ø¯ Ø¬Ø§ÛŒØ²Ù‡">
  <button onclick="useCode()">Ø«Ø¨Øª Ú©Ø¯</button>

  <h3>Ù…ÙˆØ¬ÙˆØ¯ÛŒ: <span id="balance">-</span> Ø¯Ù„Ø§Ø±</h3>

  <h2>Ø¬Ø¯ÙˆÙ„ Ø§Ù…ØªÛŒØ§Ø²Ø§Øª</h2>
  <table>
    <thead>
      <tr><th>Ú©Ø§Ø±Ø¨Ø±</th><th>Ù…ÙˆØ¬ÙˆØ¯ÛŒ ($)</th></tr>
    </thead>
    <tbody id="scoreboard"></tbody>
  </table>

  <h2>Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</h2>
  <input id="adminpass" placeholder="Ø±Ù…Ø² Ù…Ø¯ÛŒØ±ÛŒØª">
  <input id="newcode" placeholder="Ú©Ø¯ Ø¬Ø¯ÛŒØ¯">
  <input id="amount" type="number" placeholder="Ù…Ù‚Ø¯Ø§Ø± Ø¯Ù„Ø§Ø±">
  <button onclick="addCode()">Ø§ÙØ²ÙˆØ¯Ù† Ú©Ø¯</button><br>
  <input id="banuser" placeholder="Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø± Ø¨Ø±Ø§ÛŒ Ø¨Ù†">
  <button onclick="ban()">Ø¨Ù† Ú©Ø±Ø¯Ù†</button>

  <div id="output"></div>

  <script>
    const adminPassword = "admin123"; // Ø±Ù…Ø² Ù…Ø¯ÛŒØ±ÛŒØª

    const users = JSON.parse(localStorage.getItem("users") || "{}");
    const codes = JSON.parse(localStorage.getItem("codes") || "[]");
    const banned = JSON.parse(localStorage.getItem("banned") || "[]");
    let currentUser = "";

    function save() {
      localStorage.setItem("users", JSON.stringify(users));
      localStorage.setItem("codes", JSON.stringify(codes));
      localStorage.setItem("banned", JSON.stringify(banned));
    }

    function showMessage(msg) {
      document.getElementById("output").innerText = msg;
      updateBoard();
    }

    function login() {
      const user = document.getElementById("username").value.trim();
      if (banned.includes(user)) return showMessage("Ø´Ù…Ø§ Ø¨Ù† Ø´Ø¯Ù‡â€ŒØ§ÛŒØ¯.");
      if (!users[user]) users[user] = 0;
      currentUser = user;
      save();
      showMessage(`Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒ ${user}`);
      updateBalance();
      updateBoard();
    }

    function useCode() {
      if (!currentUser) return showMessage("Ù„Ø·ÙØ§Ù‹ Ø§Ø¨ØªØ¯Ø§ ÙˆØ§Ø±Ø¯ Ø´ÙˆÛŒØ¯.");
      const code = document.getElementById("usercode").value.trim();
      const item = codes.find(c => c.code === code);
      if (!item) return showMessage("Ú©Ø¯ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª.");
      users[currentUser] += item.amount;
      codes.splice(codes.indexOf(item), 1);
      save();
      showMessage(`ğŸ ${item.amount}$ Ø¨Ù‡ Ø­Ø³Ø§Ø¨ Ø´Ù…Ø§ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯!`);
      updateBalance();
    }

    function updateBalance() {
      document.getElementById("balance").innerText = users[currentUser] || 0;
    }

    function updateBoard() {
      const board = document.getElementById("scoreboard");
      board.innerHTML = "";
      const sorted = Object.entries(users).sort((a,b) => b[1] - a[1]);
      for (const [user, score] of sorted) {
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${user}</td><td>${score}</td>`;
        board.appendChild(tr);
      }
    }

    function addCode() {
      const pass = document.getElementById("adminpass").value;
      const newcode = document.getElementById("newcode").value.trim();
      const amount = parseFloat(document.getElementById("amount").value);
      if (pass !== adminPassword) return showMessage("Ø±Ù…Ø² Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª.");
      if (!newcode || isNaN(amount)) return showMessage("Ù…Ù‚Ø¯Ø§Ø± Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.");
      codes.push({ code: newcode, amount });
      save();
      showMessage(`Ú©Ø¯ "${newcode}" Ø¨Ø§ Ù…Ø¨Ù„Øº ${amount}$ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯.`);
    }

    function ban() {
      const pass = document.getElementById("adminpass").value;
      if (pass !== adminPassword) return showMessage("Ø±Ù…Ø² Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª.");
      const user = document.getElementById("banuser").value.trim();
      if (!user) return showMessage("Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ ÙˆØ§Ø±Ø¯ Ù†Ø´Ø¯Ù‡.");
      if (!banned.includes(user)) banned.push(user);
      save();
      showMessage(`Ú©Ø§Ø±Ø¨Ø± ${user} Ø¨Ù† Ø´Ø¯.`);
    }

    updateBoard(); // Load scoreboard on page load
  </script>
</body>
</html>
